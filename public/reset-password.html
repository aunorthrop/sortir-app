<!DOCTYPE html>
<html>
<head>
  <title>Reset Password - Sortir</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <img src="sortir-logo.png" alt="Sortir Logo" class="header-logo">
  </header>

  <form id="resetForm">
    <h2>Reset Password</h2>
    <input type="password" id="newPassword" placeholder="New password" required />
    <button type="submit">Reset Password</button>
    <div id="resetMessage" class="error-message"></div>
  </form>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const email = urlParams.get("email");
    const token = urlParams.get("token");
    const form = document.getElementById("resetForm");
    const msg = document.getElementById("resetMessage");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const newPassword = document.getElementById("newPassword").value;

      fetch("/reset-password", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, token, newPassword }),
      })
        .then((res) => res.json())
        .then((data) => {
          if (data.success) {
            msg.textContent = "Password reset successful! You may now log in.";
            msg.style.color = "#00ffff";
          } else {
            msg.textContent = data.error || "Reset failed.";
          }
        })
        .catch(() => {
          msg.textContent = "Something went wrong.";
        });
    });
  </script>
</body>
</html>
